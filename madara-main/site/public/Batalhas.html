<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/Header.css">
    <title>Document</title>
</head>
<body>
    <div class="banner">
        <video autoplay loop muted>
            <source src="assets/yt5s.io-Madara Uchiha 4K live wallpaper _)))-(1080p60).mp4" type="video/mp4">
        </video>
        <div class="header">
            <div class="container">
                <li id="logo">Uchiha Madara</li>
                <div class="navbar">
                    <li><a href="index.html">Inicio</li>
                    <li id="aqui">Batalhas</li>
                    <li id="logado" style="display: none;"><a href="../Logado/Grafico.html">grafico</a></li>
                    <li><a href="galeria.html">Galeria</a></li>
                    <li id="logado" style="display: none;"><a href="../Logado/Quiz-madara.html">Quiz</a></li>
                    <li>|</li>
                    <li id="deslogado" style="display: block;"><a href="Login-Madara.html">Login</a></li>
                    <li id="deslogado" style="display: block;"><a href="Cadastrar-Madara.html">Cadastrar</a></li>   
                    <li id="logado" style="display: none;">Olá, <span id="logado_usuario"></span></a></li>
                    <li id="logado" style="display: none;"><select  name="perfil1" id="perfil" onclick="sair()" onchange="location.href=this.value">
                        <option value=""></option>
                        <option value="Perfil.html">Perfil</option>
                        <option value="Batalhas.html">Sair
                        </option>
                    </select></li>
                </div>
            </div>
        </div>
    </div>
    
    <span id="frasetest">aquiiiii</span>
</body>
</html>
<script>
    if(sessionStorage.length == 0){

    }else{
        logado[0].style.display ='block';
        logado[1].style.display ='block';
        logado[2].style.display ='block';
        logado[3].style.display ='block';
        deslogado[0].style.display ='none';
        deslogado[1].style.display ='none';
        logado_usuario.innerHTML = sessionStorage.NOME_USUARIO;
        var fotousuario = sessionStorage.FOTO_USUARIO;
        document.getElementById('perfil').style.backgroundImage = `url("../Assets/${fotousuario}")`;

    }
    fotoPerfil()


    function sair(){
        if(perfil.value == 'Batalhas.html'){
        sessionStorage.clear()
        }
    }
    var linkFoto = ''

    function fotoPerfil() {
        fetch("/usuarios/fotoPerfil", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            // crie um atributo que recebe o valor recuperado aqui
            // Agora vá para o arquivo routes/usuario.js
            linkFotoServer: linkFoto
          }),
        })
          .then(function (resposta) {
            if (resposta.ok) {
              console.log(resposta);
    
              resposta.json().then((json) => {
                console.log(json);
                console.log("Resposta" + JSON.stringify(json));
    
                setTimeout(function () {
                  sessionStorage.FOTO_USUARIO = json.linkFoto;
                  console.log(sessionStorage.FOTO_USUARIO);
                  if (sessionStorage.FOTO_USUARIO == "undefined") {
                    console.log("Ainda não tem frase");
                  } else {
                    frasetest.innerHTML = sessionStorage.FOTO_USUARIO;
              
                  }
                }, 10); // apenas para exibir o loading
              });
            } else {
              console.log("Houve um erro ao tentar realizar o login!");
            }
          })
          .catch(function (erro) {
            console.log(erro);
          });
    
        return false;
      }
</script>